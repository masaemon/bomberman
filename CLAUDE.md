# CLAUDE.md - AI開発コンテキスト

このファイルは、AIアシスタント（Claude）がこのプロジェクトを理解し、効率的に開発を支援するための情報をまとめたものです。

## プロジェクト概要

**プロジェクト名**: Bomberman Game
**目的**: ブラウザで動作する2Dボンバーマンゲーム（趣味プロジェクト）
**開発者**: シングル開発者、プログラミング経験あり

## 技術スタック

```
言語: TypeScript
ビルドツール: Vite
ゲームエンジン: Phaser 3.70.0
プラットフォーム: Webブラウザ
```

## プロジェクト構造

```
bomberman/
├── docs/                       # ドキュメント
│   ├── SPECIFICATION.md        # 詳細仕様書
│   └── TICKETS.md              # 開発チケット一覧
├── src/
│   ├── main.ts                 # エントリーポイント
│   ├── config/
│   │   └── GameConfig.ts       # ゲーム設定
│   ├── scenes/
│   │   └── GameScene.ts        # メインゲームシーン
│   ├── entities/
│   │   ├── Player.ts           # プレイヤー
│   │   ├── Enemy.ts            # 敵AI
│   │   ├── Bomb.ts             # 爆弾
│   │   ├── Explosion.ts        # 爆発
│   │   └── PowerUp.ts          # パワーアップ
│   ├── map/
│   │   └── Map.ts              # マップ管理
│   ├── ai/
│   │   └── SimpleAI.ts         # AI行動ロジック
│   └── utils/
│       └── FieldShrink.ts      # フィールド縮小
├── index.html
├── package.json
├── tsconfig.json
├── claude.md                   # 開発ログ（小文字版）
└── CLAUDE.md                   # このファイル
```

## 重要な設計決定事項

### 1. フィールドサイズ
- **設定可能**: ゲーム設定で変更できるように実装
- **デフォルト**: 横30マス × 縦15マス（全デバイス共通）
- **理由**: ユーザーの明確な要望

### 2. ゲームモード
- **シングルプレイヤーのみ**: 1人 vs AI 3体
- **将来の拡張**: マルチプレイヤーは考慮するが、現時点では実装しない

### 3. AI難易度
- **初期実装**: シンプルなランダムAI
- **段階的改良**: 後から賢いAIを追加可能な設計

### 4. フィールド縮小
- **必須機能**: ゲームの核となる要素
- **タイミング**: 60秒後から開始、15秒ごとに縮小

### 5. モバイル対応
- **必須機能**: PC・スマホ両対応
- **タッチ操作**: 仮想コントローラー（十字キー + 爆弾ボタン）
- **レスポンシブ**: 画面サイズに応じて自動スケーリング

## 開発方針

### コーディングスタイル
- TypeScript strict mode有効
- 明確な型定義
- クラスベースの設計（Phaserと相性が良い）
- 適度なコメント（日本語可）
- **Phaser + TypeScriptのベストプラクティスに従う**

### Phaser + TypeScript ベストプラクティス

#### 1. シーン管理
- シーンはクラスとして定義し、`Phaser.Scene`を継承
- `create()`, `update()`, `preload()`メソッドを適切に使用
- シーン間のデータ受け渡しは`registry`または`data`を使用

#### 2. ゲームオブジェクト
- カスタムゲームオブジェクトは`Phaser.GameObjects.Sprite`や`Container`を継承
- プロパティには明確な型定義を付与
- `update()`メソッドで状態を更新

#### 3. グループとオブジェクトプール
- 同種のオブジェクトは`Phaser.GameObjects.Group`で管理
- 頻繁に生成/破棄するオブジェクトはオブジェクトプールを活用

#### 4. 物理エンジン
- Arcade Physicsを使用（シンプルで軽量）
- 衝突判定は`this.physics.add.collider()`や`overlap()`を使用
- 物理ボディのサイズは適切に設定

#### 5. 入力処理
- キーボード: `this.input.keyboard.addKey()`
- タッチ: `this.input.on('pointerdown')`など
- 入力状態の管理はクラスプロパティに保持

#### 6. アセット管理
- 画像・音声は`preload()`で事前読み込み
- アセットキーは定数として定義（typoを防ぐ）

#### 7. パフォーマンス
- `setDepth()`でレンダリング順序を最適化
- 不要なオブジェクトは`destroy()`で破棄
- 大量のオブジェクトは可視範囲外を非表示に

#### 8. 設定の分離
- ゲーム設定は別ファイル（GameConfig.ts）に分離
- マジックナンバーは定数として定義

### 実装の優先順位
1. **Phase 2**: コア機能（マップ、プレイヤー、爆弾）
2. **Phase 3**: AI実装
3. **Phase 3.5**: モバイル対応（仮想コントローラー）
4. **Phase 4**: パワーアップ、フィールド縮小
5. **Phase 5**: UI/UX改善
6. **Phase 6**: 最適化・調整

### テスト戦略
- 開発初期は手動テストのみ
- 必要に応じて単体テストを追加

## よくある質問（FAQ）

### Q: なぜPhaserを選んだのか？
A: 2Dゲームに最適で、TypeScriptサポートが充実しており、学習コストに対して得られる機能が豊富だから。

### Q: マルチプレイヤーは？
A: 現時点では実装しないが、将来の拡張として考慮。

### Q: グラフィックは？
A: 初期は仮グラフィック（単色の矩形）で実装。後からスプライトを追加可能。

### Q: モバイル対応は？
A: PC・スマホ両対応。レスポンシブデザインと仮想コントローラーでタッチ操作を実装。

## AI支援時の注意事項

### コード生成時
1. **必ず型定義を明示する**
2. **Phaser + TypeScriptのベストプラクティスに従う**（上記セクション参照）
3. **設定値はハードコードせず、GameConfigから読み込む**
4. コメントは重要な部分のみ（過度なコメントは不要）
5. クラスベースの設計を徹底
6. 物理エンジン（Arcade Physics）を適切に活用

### 質問への対応
1. 仕様は `docs/SPECIFICATION.md` を参照
2. タスクは `docs/TICKETS.md` を参照
3. 不明点は確認してから実装

### ファイル作成時
1. 既存の構造に従う
2. 適切なディレクトリに配置
3. importパスは相対パスで明確に

## 現在の開発ステータス

**フェーズ**: Phase 1 完了、Phase 2 開始準備

**完了**:
- ✅ プロジェクトセットアップ
- ✅ ドキュメント作成
- ✅ GitHub Pages デプロイ設定
- ✅ モバイル対応仕様追加

**次のステップ**:
- [ ] TICKET-002: GameConfig作成
- [ ] TICKET-003: マップ生成システム
- [ ] TICKET-004: 基本レンダリング

## 参考リンク

- [Phaser 3 Documentation](https://photonstorm.github.io/phaser3-docs/)
- [TypeScript Handbook](https://www.typescriptlang.org/docs/)
- [Vite Guide](https://vitejs.dev/guide/)

## バージョン履歴

- **2026-01-07**:
  - プロジェクト初期化、ドキュメント作成
  - GitHub Pages デプロイ設定
  - モバイル対応仕様追加
  - Phaser + TypeScript ベストプラクティス追記

---

**Note**: このファイルはプロジェクトの進行に合わせて更新してください。
